<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="comment">% magnetometer calibration</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% Jungtaek Kim</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% jungtaek.kim@jt-inc.net</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T42U3">A_i</span>, <span class="var type1" id="S3T43U4">B</span>]=magCali(<span class="var type1" id="S4T1U7">data</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line">    <span class="mxinfo" id="T2:U4">[<span class="var type1" id="S5T2U11">n</span>,<span class="var type1" id="S6T2U12">m</span>]=size(<span class="var type1" id="S4T1U15">data</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S6T2U19">m</span> ~= 3</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line">        exit;</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line">    <span class="mxinfo" id="T3:U9"><span class="var type1" id="S9T3U26">D</span> = <span class="mxinfo" id="T3:U11">zeros(<span class="mxinfo" id="T2:U12"><span class="var type1" id="S5T2U29">n</span></span>, <span class="mxinfo" id="T2:U14">10</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S11T2U33">i</span> = <span class="mxinfo" id="T2:U16">1</span>:<span class="var type1" id="S5T2U36">n</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line">        <span class="mxinfo" id="T2:U18"><span class="mxinfo" id="T2:U19"><span class="var type1" id="S9T3U40">D</span>(<span class="var type1" id="S11T2U41">i</span>, <span class="mxinfo" id="T2:U22">1</span>)</span> = <span class="mxinfo" id="T2:U23"><span class="mxinfo" id="T2:U24"><span class="var type1" id="S4T1U45">data</span>(<span class="var type1" id="S11T2U46">i</span>,<span class="mxinfo" id="T2:U27">1</span>)</span>*<span class="mxinfo" id="T2:U28"><span class="var type1" id="S4T1U49">data</span>(<span class="var type1" id="S11T2U50">i</span>,<span class="mxinfo" id="T2:U31">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line">        <span class="mxinfo" id="T2:U32"><span class="mxinfo" id="T2:U33"><span class="var type1" id="S9T3U55">D</span>(<span class="var type1" id="S11T2U56">i</span>, <span class="mxinfo" id="T2:U36">2</span>)</span> = <span class="mxinfo" id="T2:U37"><span class="mxinfo" id="T2:U38"><span class="var type1" id="S4T1U60">data</span>(<span class="var type1" id="S11T2U61">i</span>,<span class="mxinfo" id="T2:U41">2</span>)</span>*<span class="mxinfo" id="T2:U42"><span class="var type1" id="S4T1U64">data</span>(<span class="var type1" id="S11T2U65">i</span>,<span class="mxinfo" id="T2:U45">2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line">        <span class="mxinfo" id="T2:U46"><span class="mxinfo" id="T2:U47"><span class="var type1" id="S9T3U70">D</span>(<span class="var type1" id="S11T2U71">i</span>, <span class="mxinfo" id="T2:U50">3</span>)</span> = <span class="mxinfo" id="T2:U51"><span class="mxinfo" id="T2:U52"><span class="var type1" id="S4T1U75">data</span>(<span class="var type1" id="S11T2U76">i</span>,<span class="mxinfo" id="T2:U55">3</span>)</span>*<span class="mxinfo" id="T2:U56"><span class="var type1" id="S4T1U79">data</span>(<span class="var type1" id="S11T2U80">i</span>,<span class="mxinfo" id="T2:U59">3</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line">        <span class="mxinfo" id="T2:U60"><span class="mxinfo" id="T2:U61"><span class="var type1" id="S9T3U85">D</span>(<span class="var type1" id="S11T2U86">i</span>, <span class="mxinfo" id="T2:U64">4</span>)</span> = <span class="mxinfo" id="T2:U65"><span class="mxinfo" id="T2:U66"><span class="mxinfo" id="T2:U67">2.0</span>*<span class="mxinfo" id="T2:U68"><span class="var type1" id="S4T1U92">data</span>(<span class="var type1" id="S11T2U93">i</span>,<span class="mxinfo" id="T2:U71">2</span>)</span></span>*<span class="mxinfo" id="T2:U72"><span class="var type1" id="S4T1U96">data</span>(<span class="var type1" id="S11T2U97">i</span>,<span class="mxinfo" id="T2:U75">3</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line">        <span class="mxinfo" id="T2:U76"><span class="mxinfo" id="T2:U77"><span class="var type1" id="S9T3U102">D</span>(<span class="var type1" id="S11T2U103">i</span>, <span class="mxinfo" id="T2:U80">5</span>)</span> = <span class="mxinfo" id="T2:U81"><span class="mxinfo" id="T2:U82"><span class="mxinfo" id="T2:U83">2.0</span>*<span class="mxinfo" id="T2:U84"><span class="var type1" id="S4T1U109">data</span>(<span class="var type1" id="S11T2U110">i</span>,<span class="mxinfo" id="T2:U87">1</span>)</span></span>*<span class="mxinfo" id="T2:U88"><span class="var type1" id="S4T1U113">data</span>(<span class="var type1" id="S11T2U114">i</span>,<span class="mxinfo" id="T2:U91">3</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line">        <span class="mxinfo" id="T2:U92"><span class="mxinfo" id="T2:U93"><span class="var type1" id="S9T3U119">D</span>(<span class="var type1" id="S11T2U120">i</span>, <span class="mxinfo" id="T2:U96">6</span>)</span> = <span class="mxinfo" id="T2:U97"><span class="mxinfo" id="T2:U98"><span class="mxinfo" id="T2:U99">2.0</span>*<span class="mxinfo" id="T2:U100"><span class="var type1" id="S4T1U126">data</span>(<span class="var type1" id="S11T2U127">i</span>,<span class="mxinfo" id="T2:U103">1</span>)</span></span>*<span class="mxinfo" id="T2:U104"><span class="var type1" id="S4T1U130">data</span>(<span class="var type1" id="S11T2U131">i</span>,<span class="mxinfo" id="T2:U107">2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line">        <span class="mxinfo" id="T2:U108"><span class="mxinfo" id="T2:U109"><span class="var type1" id="S9T3U136">D</span>(<span class="var type1" id="S11T2U137">i</span>, <span class="mxinfo" id="T2:U112">7</span>)</span> = <span class="mxinfo" id="T2:U113"><span class="mxinfo" id="T2:U114">2.0</span>*<span class="mxinfo" id="T2:U115"><span class="var type1" id="S4T1U142">data</span>(<span class="var type1" id="S11T2U143">i</span>,<span class="mxinfo" id="T2:U118">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line">        <span class="mxinfo" id="T2:U119"><span class="mxinfo" id="T2:U120"><span class="var type1" id="S9T3U148">D</span>(<span class="var type1" id="S11T2U149">i</span>, <span class="mxinfo" id="T2:U123">8</span>)</span> = <span class="mxinfo" id="T2:U124"><span class="mxinfo" id="T2:U125">2.0</span>*<span class="mxinfo" id="T2:U126"><span class="var type1" id="S4T1U154">data</span>(<span class="var type1" id="S11T2U155">i</span>,<span class="mxinfo" id="T2:U129">2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line">        <span class="mxinfo" id="T2:U130"><span class="mxinfo" id="T2:U131"><span class="var type1" id="S9T3U160">D</span>(<span class="var type1" id="S11T2U161">i</span>, <span class="mxinfo" id="T2:U134">9</span>)</span> = <span class="mxinfo" id="T2:U135"><span class="mxinfo" id="T2:U136">2.0</span>*<span class="mxinfo" id="T2:U137"><span class="var type1" id="S4T1U166">data</span>(<span class="var type1" id="S11T2U167">i</span>,<span class="mxinfo" id="T2:U140">3</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line">        <span class="mxinfo" id="T2:U141"><span class="mxinfo" id="T2:U142"><span class="var type1" id="S9T3U172">D</span>(<span class="var type1" id="S11T2U173">i</span>, <span class="mxinfo" id="T2:U145">10</span>)</span> = <span class="mxinfo" id="T2:U146">1.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line">    <span class="mxinfo" id="T10:U147"><span class="var type1" id="S12T10U178">S</span> = <span class="mxinfo" id="T10:U149"><span class="mxinfo" id="T4:U150"><span class="var type1" id="S9T3U181">D</span>'</span> * <span class="var type1" id="S9T3U182">D</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line">    <span class="mxinfo" id="T27:U153"><span class="var type1" id="S13T27U185">C</span> = <span class="mxinfo" id="T27:U155">[0.0,  0.5,  0.5,  0.0,  0.0,  0.0;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="mxinfo" id="T27:U153"><span class="mxinfo" id="T27:U155">         0.5,  0.0,  0.5,  0.0,  0.0,  0.0;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="mxinfo" id="T27:U153"><span class="mxinfo" id="T27:U155">         0.5,  0.5,  0.0,  0.0,  0.0,  0.0;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"><span class="mxinfo" id="T27:U153"><span class="mxinfo" id="T27:U155">         0.0,  0.0,  0.0,-0.25,  0.0,  0.0;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo" id="T27:U153"><span class="mxinfo" id="T27:U155">         0.0,  0.0,  0.0,  0.0,-0.25,  0.0;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="mxinfo" id="T27:U153"><span class="mxinfo" id="T27:U155">         0.0,  0.0,  0.0,  0.0,  0.0,-0.25]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line">         </span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line">     </span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line">    <span class="mxinfo" id="T27:U156"><span class="var type1" id="S14T27U234">CC</span> = <span class="mxinfo" id="T27:U158">[<span class="mxinfo" id="T48:U159"><span class="mxinfo" id="T2:U160">-<span class="mxinfo" id="T2:U161">1.0</span></span>,  <span class="mxinfo" id="T2:U162">1.0</span>,  <span class="mxinfo" id="T2:U163">1.0</span>,  <span class="mxinfo" id="T2:U164">0.0</span>,  <span class="mxinfo" id="T2:U165">0.0</span>,  <span class="mxinfo" id="T2:U166">0.0</span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="mxinfo" id="T27:U156"><span class="mxinfo" id="T27:U158">           <span class="mxinfo" id="T48:U167"><span class="mxinfo" id="T2:U168">1.0</span>, <span class="mxinfo" id="T2:U169">-<span class="mxinfo" id="T2:U170">1.0</span></span>,  <span class="mxinfo" id="T2:U171">1.0</span>,  <span class="mxinfo" id="T2:U172">0.0</span>,  <span class="mxinfo" id="T2:U173">0.0</span>,  <span class="mxinfo" id="T2:U174">0.0</span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="mxinfo" id="T27:U156"><span class="mxinfo" id="T27:U158">           <span class="mxinfo" id="T48:U175"><span class="mxinfo" id="T2:U176">1.0</span>,  <span class="mxinfo" id="T2:U177">1.0</span>, <span class="mxinfo" id="T2:U178">-<span class="mxinfo" id="T2:U179">1.0</span></span>,  <span class="mxinfo" id="T2:U180">0.0</span>,  <span class="mxinfo" id="T2:U181">0.0</span>,  <span class="mxinfo" id="T2:U182">0.0</span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="mxinfo" id="T27:U156"><span class="mxinfo" id="T27:U158">           <span class="mxinfo" id="T48:U183"><span class="mxinfo" id="T2:U184">0.0</span>,  <span class="mxinfo" id="T2:U185">0.0</span>,  <span class="mxinfo" id="T2:U186">0.0</span>, <span class="mxinfo" id="T2:U187">-<span class="mxinfo" id="T2:U188">4.0</span></span>,  <span class="mxinfo" id="T2:U189">0.0</span>,  <span class="mxinfo" id="T2:U190">0.0</span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="mxinfo" id="T27:U156"><span class="mxinfo" id="T27:U158">           <span class="mxinfo" id="T48:U191"><span class="mxinfo" id="T2:U192">0.0</span>,  <span class="mxinfo" id="T2:U193">0.0</span>,  <span class="mxinfo" id="T2:U194">0.0</span>,  <span class="mxinfo" id="T2:U195">0.0</span>, <span class="mxinfo" id="T2:U196">-<span class="mxinfo" id="T2:U197">4.0</span></span>,  <span class="mxinfo" id="T2:U198">0.0</span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"><span class="mxinfo" id="T27:U156"><span class="mxinfo" id="T27:U158">           <span class="mxinfo" id="T48:U199"><span class="mxinfo" id="T2:U200">0.0</span>,  <span class="mxinfo" id="T2:U201">0.0</span>,  <span class="mxinfo" id="T2:U202">0.0</span>,  <span class="mxinfo" id="T2:U203">0.0</span>,  <span class="mxinfo" id="T2:U204">0.0</span>, <span class="mxinfo" id="T2:U205">-<span class="mxinfo" id="T2:U206">4.0</span></span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line">    <span class="mxinfo" id="T27:U207"><span class="var type1" id="S15T27U286">S11</span> = <span class="mxinfo" id="T27:U209"><span class="var type1" id="S12T10U288">S</span>(<span class="mxinfo" id="T35:U211"><span class="mxinfo" id="T2:U212">1</span>:<span class="mxinfo" id="T2:U213">6</span></span>, <span class="mxinfo" id="T35:U214"><span class="mxinfo" id="T2:U215">1</span>:<span class="mxinfo" id="T2:U216">6</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line">    <span class="mxinfo" id="T28:U217"><span class="var type1" id="S16T28U297">S12</span> = <span class="mxinfo" id="T28:U219"><span class="var type1" id="S12T10U299">S</span>(<span class="mxinfo" id="T35:U221"><span class="mxinfo" id="T2:U222">1</span>:<span class="mxinfo" id="T2:U223">6</span></span>, <span class="mxinfo" id="T49:U224"><span class="mxinfo" id="T2:U225">7</span>:<span class="mxinfo" id="T2:U226">10</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line">    <span class="mxinfo" id="T29:U227"><span class="var type1" id="S17T29U308">S21</span> = <span class="mxinfo" id="T29:U229"><span class="var type1" id="S12T10U310">S</span>(<span class="mxinfo" id="T49:U231"><span class="mxinfo" id="T2:U232">7</span>:<span class="mxinfo" id="T2:U233">10</span></span>, <span class="mxinfo" id="T35:U234"><span class="mxinfo" id="T2:U235">1</span>:<span class="mxinfo" id="T2:U236">6</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line">    <span class="mxinfo" id="T18:U237"><span class="var type1" id="S18T18U319">S22</span> = <span class="mxinfo" id="T18:U239"><span class="var type1" id="S12T10U321">S</span>(<span class="mxinfo" id="T49:U241"><span class="mxinfo" id="T2:U242">7</span>:<span class="mxinfo" id="T2:U243">10</span></span>, <span class="mxinfo" id="T49:U244"><span class="mxinfo" id="T2:U245">7</span>:<span class="mxinfo" id="T2:U246">10</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line">    <span class="mxinfo" id="T18:U247"><span class="var type1" id="S19T18U330">I4</span> = <span class="mxinfo" id="T18:U249">eye(4)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line">    <span class="mxinfo" id="T18:U250"><span class="var type1" id="S21T18U336">L_S22</span> = <span class="mxinfo" id="T18:U252">chol(<span class="var type1" id="S18T18U339">S22</span>, <span class="string">'lower'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line">    <span class="mxinfo" id="T18:U254"><span class="var type1" id="S23T18U343">L_S22_i</span> = <span class="mxinfo" id="T18:U256">inv(<span class="var type1" id="S21T18U346">L_S22</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line">    <span class="mxinfo" id="T18:U258"><span class="var type1" id="S25T18U349">L_S22_t_i</span> = <span class="mxinfo" id="T18:U260">inv(<span class="mxinfo" id="T18:U261"><span class="var type1" id="S21T18U353">L_S22</span>'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line">    <span class="mxinfo" id="T18:U263"><span class="var type1" id="S26T18U356">S22_i</span> = <span class="mxinfo" id="T18:U265"><span class="var type1" id="S25T18U358">L_S22_t_i</span> * <span class="var type1" id="S23T18U359">L_S22_i</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="comment">%     S22_i = pinv(S22);%I4\S22;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line">    <span class="mxinfo" id="T27:U268"><span class="var type1" id="S27T27U362">SS</span> = <span class="mxinfo" id="T27:U270"><span class="var type1" id="S15T27U364">S11</span> - <span class="mxinfo" id="T27:U272"><span class="mxinfo" id="T28:U273"><span class="var type1" id="S16T28U367">S12</span> * <span class="var type1" id="S26T18U368">S22_i</span></span> * <span class="var type1" id="S17T29U369">S21</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line">    <span class="mxinfo" id="T27:U277"><span class="var type1" id="S28T27U372">E</span> = <span class="mxinfo" id="T27:U279"><span class="var type1" id="S13T27U374">C</span> * <span class="var type1" id="S27T27U375">SS</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">    <span class="mxinfo" id="T31:U282">[<span class="var type1" id="S29T31U379">V</span>,<span class="var type1" id="S30T31U380">L</span>] = eig(<span class="var type1" id="S28T27U383">E</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">    <span class="mxinfo" id="T30:U286"><span class="var type1" id="S32T30U386">max</span> = <span class="mxinfo" id="T30:U288"><span class="var type1" id="S30T31U388">L</span>(<span class="mxinfo" id="T2:U290">1</span>, <span class="mxinfo" id="T2:U291">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line">    <span class="mxinfo" id="T2:U292"><span class="var type1" id="S33T2U393">ind</span> = <span class="mxinfo" id="T2:U294">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S11T2U397">i</span> = <span class="mxinfo" id="T2:U296">1</span>:6</span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T5:U297"><span class="var type1" id="S32T30U404">max</span> &lt; <span class="mxinfo" id="T30:U299"><span class="var type1" id="S30T31U406">L</span>(<span class="var type1" id="S11T2U407">i</span>,<span class="var type1" id="S11T2U408">i</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line">            <span class="mxinfo" id="T30:U303"><span class="var type1" id="S32T30U411">max</span> = <span class="mxinfo" id="T30:U305"><span class="var type1" id="S30T31U413">L</span>(<span class="var type1" id="S11T2U414">i</span>,<span class="var type1" id="S11T2U415">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">            <span class="mxinfo" id="T2:U309"><span class="var type1" id="S33T2U418">ind</span> = <span class="var type1" id="S11T2U419">i</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">    <span class="mxinfo" id="T34:U312"><span class="var type1" id="S34T34U422">v1</span> = <span class="mxinfo" id="T34:U314"><span class="var type1" id="S29T31U424">V</span>(:, <span class="var type1" id="S33T2U426">ind</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T5:U317"><span class="mxinfo" id="T30:U318"><span class="var type1" id="S34T34U431">v1</span>(<span class="mxinfo" id="T2:U320">1</span>)</span> &lt; <span class="mxinfo" id="T2:U321">0.0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">        <span class="mxinfo" id="T34:U322"><span class="var type1" id="S34T34U436">v1</span> = <span class="mxinfo" id="T34:U324">- <span class="var type1" id="S34T34U438">v1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">    <span class="mxinfo" id="T2:U326"><span class="var type1" id="S35T2U441">norm_v1</span> = <span class="mxinfo" id="T2:U328">norm(<span class="var type1" id="S34T34U444">v1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">    <span class="mxinfo" id="T34:U330"><span class="var type1" id="S34T34U447">v1</span> = <span class="mxinfo" id="T34:U332"><span class="var type1" id="S34T34U449">v1</span>/<span class="var type1" id="S35T2U450">norm_v1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">    <span class="mxinfo" id="T39:U335"><span class="var type1" id="S37T39U453">v2</span> = <span class="mxinfo" id="T39:U337"><span class="mxinfo" id="T29:U338"><span class="var type1" id="S26T18U456">S22_i</span> * <span class="var type1" id="S17T29U457">S21</span></span> * <span class="var type1" id="S34T34U458">v1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">    <span class="mxinfo" id="T10:U342"><span class="var type1" id="S38T10U461">v</span> = <span class="mxinfo" id="T10:U344">zeros(10)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">    <span class="mxinfo" id="T40:U345"><span class="var type1" id="S38T40U467">v</span> = <span class="mxinfo" id="T40:U347">complex(<span class="mxinfo" id="T10:U348"><span class="var type1" id="S38T10U470">v</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">    <span class="mxinfo" id="T30:U350"><span class="mxinfo" id="T30:U351"><span class="var type1" id="S38T40U474">v</span>(<span class="mxinfo" id="T2:U353">1</span>)</span> = <span class="mxinfo" id="T30:U354"><span class="var type1" id="S34T34U477">v1</span>(<span class="mxinfo" id="T2:U356">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">    <span class="mxinfo" id="T30:U357"><span class="mxinfo" id="T30:U358"><span class="var type1" id="S38T40U482">v</span>(<span class="mxinfo" id="T2:U360">2</span>)</span> = <span class="mxinfo" id="T30:U361"><span class="var type1" id="S34T34U485">v1</span>(<span class="mxinfo" id="T2:U363">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">    <span class="mxinfo" id="T30:U364"><span class="mxinfo" id="T30:U365"><span class="var type1" id="S38T40U490">v</span>(<span class="mxinfo" id="T2:U367">3</span>)</span> = <span class="mxinfo" id="T30:U368"><span class="var type1" id="S34T34U493">v1</span>(<span class="mxinfo" id="T2:U370">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">    <span class="mxinfo" id="T30:U371"><span class="mxinfo" id="T30:U372"><span class="var type1" id="S38T40U498">v</span>(<span class="mxinfo" id="T2:U374">4</span>)</span> = <span class="mxinfo" id="T30:U375"><span class="var type1" id="S34T34U501">v1</span>(<span class="mxinfo" id="T2:U377">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">    <span class="mxinfo" id="T30:U378"><span class="mxinfo" id="T30:U379"><span class="var type1" id="S38T40U506">v</span>(<span class="mxinfo" id="T2:U381">5</span>)</span> = <span class="mxinfo" id="T30:U382"><span class="var type1" id="S34T34U509">v1</span>(<span class="mxinfo" id="T2:U384">5</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">    <span class="mxinfo" id="T30:U385"><span class="mxinfo" id="T30:U386"><span class="var type1" id="S38T40U514">v</span>(<span class="mxinfo" id="T2:U388">6</span>)</span> = <span class="mxinfo" id="T30:U389"><span class="var type1" id="S34T34U517">v1</span>(<span class="mxinfo" id="T2:U391">6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">    <span class="mxinfo" id="T30:U392"><span class="mxinfo" id="T30:U393"><span class="var type1" id="S38T40U522">v</span>(<span class="mxinfo" id="T2:U395">7</span>)</span> = <span class="mxinfo" id="T30:U396">-<span class="mxinfo" id="T30:U397"><span class="var type1" id="S37T39U526">v2</span>(<span class="mxinfo" id="T2:U399">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">    <span class="mxinfo" id="T30:U400"><span class="mxinfo" id="T30:U401"><span class="var type1" id="S38T40U531">v</span>(<span class="mxinfo" id="T2:U403">8</span>)</span> = <span class="mxinfo" id="T30:U404">-<span class="mxinfo" id="T30:U405"><span class="var type1" id="S37T39U535">v2</span>(<span class="mxinfo" id="T2:U407">2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">    <span class="mxinfo" id="T30:U408"><span class="mxinfo" id="T30:U409"><span class="var type1" id="S38T40U540">v</span>(<span class="mxinfo" id="T2:U411">9</span>)</span> = <span class="mxinfo" id="T30:U412">-<span class="mxinfo" id="T30:U413"><span class="var type1" id="S37T39U544">v2</span>(<span class="mxinfo" id="T2:U415">3</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">    <span class="mxinfo" id="T30:U416"><span class="mxinfo" id="T30:U417"><span class="var type1" id="S38T40U549">v</span>(<span class="mxinfo" id="T2:U419">10</span>)</span> = <span class="mxinfo" id="T30:U420">-<span class="mxinfo" id="T30:U421"><span class="var type1" id="S37T39U553">v2</span>(<span class="mxinfo" id="T2:U423">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">    <span class="mxinfo" id="T42:U424"><span class="var type1" id="S40T42U557">Q</span> = <span class="mxinfo" id="T42:U426">[<span class="mxinfo" id="T44:U427"><span class="mxinfo" id="T30:U428"><span class="var type1" id="S38T40U561">v</span>(<span class="mxinfo" id="T2:U430">1</span>)</span>, <span class="mxinfo" id="T30:U431"><span class="var type1" id="S38T40U564">v</span>(<span class="mxinfo" id="T2:U433">6</span>)</span>, <span class="mxinfo" id="T30:U434"><span class="var type1" id="S38T40U567">v</span>(<span class="mxinfo" id="T2:U436">5</span>)</span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line"><span class="mxinfo" id="T42:U424"><span class="mxinfo" id="T42:U426">         <span class="mxinfo" id="T44:U437"><span class="mxinfo" id="T30:U438"><span class="var type1" id="S38T40U571">v</span>(<span class="mxinfo" id="T2:U440">6</span>)</span>, <span class="mxinfo" id="T30:U441"><span class="var type1" id="S38T40U574">v</span>(<span class="mxinfo" id="T2:U443">2</span>)</span>, <span class="mxinfo" id="T30:U444"><span class="var type1" id="S38T40U577">v</span>(<span class="mxinfo" id="T2:U446">4</span>)</span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line"><span class="mxinfo" id="T42:U424"><span class="mxinfo" id="T42:U426">         <span class="mxinfo" id="T44:U447"><span class="mxinfo" id="T30:U448"><span class="var type1" id="S38T40U581">v</span>(<span class="mxinfo" id="T2:U450">5</span>)</span>, <span class="mxinfo" id="T30:U451"><span class="var type1" id="S38T40U584">v</span>(<span class="mxinfo" id="T2:U453">4</span>)</span>, <span class="mxinfo" id="T30:U454"><span class="var type1" id="S38T40U587">v</span>(<span class="mxinfo" id="T2:U456">3</span>)</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">    <span class="mxinfo" id="T43:U457"><span class="var type1" id="S41T43U591">U</span> = <span class="mxinfo" id="T43:U459">[<span class="mxinfo" id="T30:U460"><span class="var type1" id="S38T40U595">v</span>(<span class="mxinfo" id="T2:U462">7</span>)</span>; <span class="mxinfo" id="T30:U463"><span class="var type1" id="S38T40U599">v</span>(<span class="mxinfo" id="T2:U465">8</span>)</span>; <span class="mxinfo" id="T30:U466"><span class="var type1" id="S38T40U603">v</span>(<span class="mxinfo" id="T2:U468">9</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">    <span class="mxinfo" id="T41:U469"><span class="var type1" id="S42T41U607">I3</span> = <span class="mxinfo" id="T41:U471">eye(3)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">    <span class="mxinfo" id="T42:U472"><span class="var type1" id="S43T42U613">L_Q</span> = <span class="mxinfo" id="T42:U474">chol(<span class="var type1" id="S40T42U616">Q</span>, <span class="string">'lower'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">    <span class="mxinfo" id="T42:U476"><span class="var type1" id="S44T42U620">L_Q_i</span> = <span class="mxinfo" id="T42:U478">inv(<span class="var type1" id="S43T42U623">L_Q</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">    <span class="mxinfo" id="T42:U480"><span class="var type1" id="S45T42U626">L_Q_t_i</span> = <span class="mxinfo" id="T42:U482">inv(<span class="mxinfo" id="T42:U483"><span class="var type1" id="S43T42U630">L_Q</span>'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">    <span class="mxinfo" id="T42:U485"><span class="var type1" id="S46T42U633">Q_i</span> = <span class="mxinfo" id="T42:U487"><span class="var type1" id="S45T42U635">L_Q_t_i</span> * <span class="var type1" id="S44T42U636">L_Q_i</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line"><span class="comment">%     Q_i = pinv(Q);%I3\Q;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">    <span class="mxinfo" id="T43:U490"><span class="var type1" id="S3T43U639">B</span> = <span class="mxinfo" id="T43:U492"><span class="var type1" id="S46T42U641">Q_i</span> * <span class="var type1" id="S41T43U642">U</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">    <span class="mxinfo" id="T43:U495"><span class="var type1" id="S3T43U645">B</span> = <span class="mxinfo" id="T43:U497">- <span class="var type1" id="S3T43U647">B</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">    <span class="mxinfo" id="T43:U499"><span class="var type1" id="S47T43U650">QB</span> = <span class="mxinfo" id="T43:U501"><span class="var type1" id="S40T42U652">Q</span> * <span class="var type1" id="S3T43U653">B</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">    <span class="mxinfo" id="T30:U504"><span class="var type1" id="S48T30U656">btqb</span> = <span class="mxinfo" id="T30:U506"><span class="mxinfo" id="T44:U507"><span class="var type1" id="S3T43U659">B</span>'</span> * <span class="var type1" id="S47T43U660">QB</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">    <span class="mxinfo" id="T30:U510"><span class="var type1" id="S49T30U663">J</span> = <span class="mxinfo" id="T30:U512"><span class="var type1" id="S38T40U665">v</span>(<span class="mxinfo" id="T2:U514">10</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">    <span class="mxinfo" id="T30:U515"><span class="var type1" id="S50T30U669">hmb</span> = <span class="mxinfo" id="T30:U517">sqrt(<span class="mxinfo" id="T30:U518"><span class="var type1" id="S48T30U673">btqb</span> - <span class="var type1" id="S49T30U674">J</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line">    <span class="mxinfo" id="T42:U521">[<span class="var type1" id="S52T42U678">VV</span>, <span class="var type1" id="S53T42U679">LL</span>] = eig(<span class="var type1" id="S40T42U682">Q</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line">    <span class="mxinfo" id="T43:U525"><span class="var type1" id="S54T43U685">VV1</span> = <span class="mxinfo" id="T43:U527"><span class="var type1" id="S52T42U687">VV</span>(:, <span class="mxinfo" id="T2:U529">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line">    <span class="mxinfo" id="T43:U530"><span class="var type1" id="S55T43U692">VV2</span> = <span class="mxinfo" id="T43:U532"><span class="var type1" id="S52T42U694">VV</span>(:, <span class="mxinfo" id="T2:U534">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">    <span class="mxinfo" id="T43:U535"><span class="var type1" id="S56T43U699">VV3</span> = <span class="mxinfo" id="T43:U537"><span class="var type1" id="S52T42U701">VV</span>(:, <span class="mxinfo" id="T2:U539">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">    <span class="mxinfo" id="T2:U540"><span class="var type1" id="S57T2U706">norm_VV1</span> = <span class="mxinfo" id="T2:U542">norm(<span class="var type1" id="S54T43U709">VV1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">    <span class="mxinfo" id="T2:U544"><span class="var type1" id="S58T2U712">norm_VV2</span> = <span class="mxinfo" id="T2:U546">norm(<span class="var type1" id="S55T43U715">VV2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">    <span class="mxinfo" id="T2:U548"><span class="var type1" id="S59T2U718">norm_VV3</span> = <span class="mxinfo" id="T2:U550">norm(<span class="var type1" id="S56T43U721">VV3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">    <span class="mxinfo" id="T43:U552"><span class="var type1" id="S54T43U724">VV1</span> = <span class="mxinfo" id="T43:U554"><span class="var type1" id="S54T43U726">VV1</span> / <span class="var type1" id="S57T2U727">norm_VV1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">    <span class="mxinfo" id="T43:U557"><span class="var type1" id="S55T43U730">VV2</span> = <span class="mxinfo" id="T43:U559"><span class="var type1" id="S55T43U732">VV2</span> / <span class="var type1" id="S58T2U733">norm_VV2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">    <span class="mxinfo" id="T43:U562"><span class="var type1" id="S56T43U736">VV3</span> = <span class="mxinfo" id="T43:U564"><span class="var type1" id="S56T43U738">VV3</span> / <span class="var type1" id="S59T2U739">norm_VV3</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line">    <span class="mxinfo" id="T42:U567"><span class="var type1" id="S52T42U742">VV</span> = <span class="mxinfo" id="T42:U569">[<span class="var type1" id="S54T43U745">VV1</span>, <span class="var type1" id="S55T43U746">VV2</span>, <span class="var type1" id="S56T43U747">VV3</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">    <span class="mxinfo" id="T42:U573"><span class="var type1" id="S60T42U750">vdz</span> = <span class="mxinfo" id="T42:U575"><span class="var type1" id="S52T42U752">VV</span> * <span class="var type1" id="S53T42U753">LL</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line">    <span class="mxinfo" id="T42:U578"><span class="var type1" id="S61T42U756">SQ</span> = <span class="mxinfo" id="T42:U580"><span class="var type1" id="S60T42U758">vdz</span> * <span class="mxinfo" id="T42:U582"><span class="var type1" id="S52T42U760">VV</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line">    <span class="mxinfo" id="T2:U584"><span class="var type1" id="S62T2U763">hm</span> = <span class="mxinfo" id="T2:U586">0.569</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line">    <span class="mxinfo" id="T42:U587"><span class="var type1" id="S2T42U767">A_i</span> = <span class="mxinfo" id="T42:U589"><span class="mxinfo" id="T42:U590"><span class="var type1" id="S61T42U770">SQ</span> * <span class="var type1" id="S62T2U771">hm</span></span> / <span class="var type1" id="S50T30U772">hmb</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line">    <span class="mxinfo" id="T47:U594"><span class="var type1" id="S13T47U775">C</span> = <span class="mxinfo" id="T47:U596"><span class="mxinfo" id="T50:U597">[<span class="mxinfo" id="T51:U598"><span class="mxinfo" id="T52:U599"><span class="var type1" id="S4T1U781">data</span>(:, <span class="mxinfo" id="T2:U601">1</span>)</span> + <span class="mxinfo" id="T30:U602"><span class="var type1" id="S3T43U785">B</span>(<span class="mxinfo" id="T2:U604">1</span>)</span></span>, <span class="mxinfo" id="T51:U605"><span class="mxinfo" id="T52:U606"><span class="var type1" id="S4T1U789">data</span>(:, <span class="mxinfo" id="T2:U608">2</span>)</span> + <span class="mxinfo" id="T30:U609"><span class="var type1" id="S3T43U793">B</span>(<span class="mxinfo" id="T2:U611">2</span>)</span></span>, <span class="mxinfo" id="T51:U612"><span class="mxinfo" id="T52:U613"><span class="var type1" id="S4T1U797">data</span>(:, <span class="mxinfo" id="T2:U615">3</span>)</span> + <span class="mxinfo" id="T30:U616"><span class="var type1" id="S3T43U801">B</span>(<span class="mxinfo" id="T2:U618">3</span>)</span></span>]</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line">    </span></span>
</pre>
